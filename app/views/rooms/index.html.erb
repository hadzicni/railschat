<div class="container-fluid">
  <!--                    <div class="bg-primary bg-opacity-10 rounded p-3 me-3">
                      <i class="bi bi-chat-square-dots text-primary fs-3"></i>
                    </div>ader Section -->
  <div class="row mb-4">
    <div class="col-12">
      <div class="card">
        <div class="card-body text-center py-5">
          <h1 class="mb-3">
            <i class="bi bi-chat-dots-fill me-3"></i>
            Willkommen bei RailsChat
          </h1>
          <p class="lead text-muted">Entdecke und tritt Chaträumen bei oder erstelle deinen eigenen Raum</p>
        </div>
      </div>
    </div>
  </div>

  <div class="row">
    <!-- Rooms List -->
    <div class="col-lg-8 mb-4">
      <div class="d-flex justify-content-between align-items-center mb-4">
        <h3>
          <i class="bi bi-door-open me-2"></i>
          Verfügbare Chaträume
        </h3>
        <span class="badge bg-primary">
          <%= pluralize(@rooms.count, 'Raum', 'Räume') %>
        </span>
      </div>

      <% if @rooms.any? %>
        <div class="row">
          <% @rooms.each do |room| %>
            <div class="col-md-6 mb-4">
              <div class="card user-card h-100">
                <div class="card-body">
                  <div class="d-flex align-items-start mb-3">
                    <div class="bg-primary bg-opacity-10 rounded-circle p-3 me-3">
                      <i class="bi bi-chat-square-text text-primary fs-4"></i>
                    </div>
                    <div class="flex-grow-1">
                      <h5 class="card-title mb-1"><%= room.name %></h5>
                      <small class="text-muted">
                        <i class="bi bi-people me-1"></i>
                        <%= pluralize(room.messages.select(:user_id).distinct.count, 'Teilnehmer') %>
                      </small>
                    </div>
                  </div>

                  <% if room.description.present? %>
                    <p class="card-text text-muted mb-3">
                      <%= truncate(room.description, length: 100) %>
                    </p>
                  <% end %>

                  <div class="d-flex justify-content-between align-items-center mb-3">
                    <small class="text-muted">
                      <i class="bi bi-chat me-1"></i>
                      <%= pluralize(room.messages.count, 'Nachricht') %>
                    </small>
                    <% if room.messages.any? %>
                      <small class="text-muted">
                        Zuletzt aktiv: <%= time_ago_in_words(room.messages.maximum(:created_at)) %> ago
                      </small>
                    <% else %>
                      <small class="text-muted">Neu</small>
                    <% end %>
                  </div>

                  <%= link_to room_path(room), class: "btn btn-primary w-100" do %>
                    <i class="bi bi-arrow-right-circle me-2"></i>
                    Chatraum betreten
                  <% end %>
                </div>
              </div>
            </div>
          <% end %>
        </div>
      <% else %>
        <div class="card">
          <div class="card-body text-center py-5">
            <i class="bi bi-chat-square-dots fs-1 text-muted mb-3 d-block"></i>
            <h5 class="text-muted mb-3">Noch keine Chaträume vorhanden</h5>
            <p class="text-muted">Sei der Erste und erstelle einen neuen Chatraum!</p>
          </div>
        </div>
      <% end %>
    </div>

    <!-- Create Room Sidebar -->
    <div class="col-lg-4">
      <div class="card sticky-top" style="top: 20px;">
        <div class="card-header">
          <h5 class="mb-0">
            <i class="bi bi-plus-circle me-2"></i>
            Neuen Chatraum erstellen
          </h5>
        </div>
        <div class="card-body">
          <%= form_with model: @room, local: true do |form| %>
            <% if @room.errors.any? %>
              <div class="alert alert-danger">
                <h6><%= pluralize(@room.errors.count, "Fehler") %>:</h6>
                <ul class="mb-0">
                  <% @room.errors.full_messages.each do |message| %>
                    <li><%= message %></li>
                  <% end %>
                </ul>
              </div>
            <% end %>

            <div class="mb-3">
              <%= form.label :name, class: "form-label" do %>
                <i class="bi bi-chat-quote me-1"></i>
                Raumname
              <% end %>
              <%= form.text_field :name, class: "form-control", placeholder: "z.B. Allgemein, Gaming, Technik..." %>
            </div>

            <div class="mb-4">
              <%= form.label :description, class: "form-label" do %>
                <i class="bi bi-card-text me-1"></i>
                Beschreibung (optional)
              <% end %>
              <%= form.text_area :description, class: "form-control", rows: 3,
                  placeholder: "Beschreibe worum es in diesem Chatraum geht..." %>
            </div>

            <%= form.submit "Chatraum erstellen", class: "btn btn-success w-100" %>
          <% end %>
        </div>
      </div>

      <!-- Quick Stats -->
      <div class="card mt-4">
        <div class="card-header">
          <h6 class="mb-0">
            <i class="bi bi-graph-up me-2"></i>
            Statistiken
          </h6>
        </div>
        <div class="card-body">
          <div class="row text-center">
            <div class="col-6 border-end">
              <div class="bg-primary bg-opacity-10 rounded p-2 mb-2">
                <i class="bi bi-door-open text-primary fs-4"></i>
              </div>
              <h6 class="mb-0"><%= Room.count %></h6>
              <small class="text-muted">Räume</small>
            </div>
            <div class="col-6">
              <div class="bg-success bg-opacity-10 rounded p-2 mb-2">
                <i class="bi bi-chat-text text-success fs-4"></i>
              </div>
              <h6 class="mb-0"><%= Message.count %></h6>
              <small class="text-muted">Nachrichten</small>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
